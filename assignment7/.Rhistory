newdata = data.frame(Bwt = X_grid),
interval = "prediction", level = 0.90)
plot(Hwt ~ Bwt, data = cats,
xlab = "Body Weight (in Kg)",
ylab = "Heart Weight (in gm)",
main = "Heart Weight vs Body Weight of male and female cats ",
pch  = 20,
cex  = 2,
col  = "grey",
ylim = c(min(Y_pi_band), max(Y_pi_band)))
abline(cat_model, lwd = 5, col = "darkorange")
lines(X_grid, Y_ci_band[,"lwr"], col = "dodgerblue", lwd = 3, lty = 2)
lines(X_grid, Y_ci_band[,"upr"], col = "dodgerblue", lwd = 3, lty = 2)
lines(X_grid, Y_pi_band[,"lwr"], col = "dodgerblue", lwd = 3, lty = 3)
lines(X_grid, Y_pi_band[,"upr"], col = "dodgerblue", lwd = 3, lty = 3)
points(mean(cats$Hwt), mean(cats$Bwt), pch = "+", cex = 3)
X_grid = seq(min(cats$Bwt), max(cats$Bwt), by = 0.01)
Y_ci_band = predict(cat_model,
newdata = data.frame(Bwt = X_grid),
interval = "confidence", level = 0.90)
Y_pi_band = predict(cat_model,
newdata = data.frame(Bwt = X_grid),
interval = "prediction", level = 0.90)
plot(Hwt ~ Bwt, data = cats,
xlab = "Body Weight (in Kg)",
ylab = "Heart Weight (in gm)",
main = "Heart Weight vs Body Weight of male and female cats ",
pch  = 20,
cex  = 2,
col  = "grey",
ylim = c(min(Y_pi_band), max(Y_pi_band)))
abline(cat_model, lwd = 5, col = "darkorange")
lines(X_grid, Y_ci_band[,"lwr"], col = "dodgerblue", lwd = 3, lty = 2)
lines(X_grid, Y_ci_band[,"upr"], col = "dodgerblue", lwd = 3, lty = 2)
lines(X_grid, Y_pi_band[,"lwr"], col = "dodgerblue", lwd = 3, lty = 3)
lines(X_grid, Y_pi_band[,"upr"], col = "dodgerblue", lwd = 3, lty = 3)
points(mean(cats$Hwt), mean(cats$Bwt), pch = "+", cex = 7)
points(mean(cats$Hwt), mean(cats$Bwt), pch = "+", cex = 7)
X_grid = seq(min(cats$Bwt), max(cats$Bwt), by = 0.01)
Y_ci_band = predict(cat_model,
newdata = data.frame(Bwt = X_grid),
interval = "confidence", level = 0.90)
Y_pi_band = predict(cat_model,
newdata = data.frame(Bwt = X_grid),
interval = "prediction", level = 0.90)
plot(Hwt ~ Bwt, data = cats,
xlab = "Body Weight (in Kg)",
ylab = "Heart Weight (in gm)",
main = "Heart Weight vs Body Weight of male and female cats ",
pch  = 20,
cex  = 2,
col  = "grey",
ylim = c(min(Y_pi_band), max(Y_pi_band)))
abline(cat_model, lwd = 5, col = "darkorange")
#lines(X_grid, Y_ci_band[,"lwr"], col = "dodgerblue", lwd = 3, lty = 2)
#lines(X_grid, Y_ci_band[,"upr"], col = "dodgerblue", lwd = 3, lty = 2)
#lines(X_grid, Y_pi_band[,"lwr"], col = "dodgerblue", lwd = 3, lty = 3)
#lines(X_grid, Y_pi_band[,"upr"], col = "dodgerblue", lwd = 3, lty = 3)
points(mean(cats$Hwt), mean(cats$Bwt), pch = "+", cex = 7)
X_grid = seq(min(cats$Bwt), max(cats$Bwt), by = 0.01)
Y_ci_band = predict(cat_model,
newdata = data.frame(Bwt = X_grid),
interval = "confidence", level = 0.90)
Y_pi_band = predict(cat_model,
newdata = data.frame(Bwt = X_grid),
interval = "prediction", level = 0.90)
plot(Hwt ~ Bwt, data = cats,
xlab = "Body Weight (in Kg)",
ylab = "Heart Weight (in gm)",
main = "Heart Weight vs Body Weight of male and female cats ",
pch  = 20,
cex  = 2,
col  = "grey",
ylim = c(min(Y_pi_band), max(Y_pi_band)))
abline(cat_model, lwd = 5, col = "darkorange")
#lines(X_grid, Y_ci_band[,"lwr"], col = "dodgerblue", lwd = 3, lty = 2)
#lines(X_grid, Y_ci_band[,"upr"], col = "dodgerblue", lwd = 3, lty = 2)
#lines(X_grid, Y_pi_band[,"lwr"], col = "dodgerblue", lwd = 3, lty = 3)
#lines(X_grid, Y_pi_band[,"upr"], col = "dodgerblue", lwd = 3, lty = 3)
#points(mean(cats$Hwt), mean(cats$Bwt), pch = "+", cex = 7)
X_grid = seq(min(cats$Bwt), max(cats$Bwt), by = 0.01)
Y_ci_band = predict(cat_model,
newdata = data.frame(Bwt = X_grid),
interval = "confidence", level = 0.90)
Y_pi_band = predict(cat_model,
newdata = data.frame(Bwt = X_grid),
interval = "prediction", level = 0.90)
plot(Hwt ~ Bwt, data = cats,
xlab = "Body Weight (in Kg)",
ylab = "Heart Weight (in gm)",
main = "Heart Weight vs Body Weight of male and female cats ",
pch  = 20,
cex  = 2,
col  = "grey",
ylim = c(min(Y_pi_band), max(Y_pi_band)))
abline(cat_model, lwd = 5, col = "darkorange")
#lines(X_grid, Y_ci_band[,"lwr"], col = "dodgerblue", lwd = 3, lty = 2)
#lines(X_grid, Y_ci_band[,"upr"], col = "dodgerblue", lwd = 3, lty = 2)
#lines(X_grid, Y_pi_band[,"lwr"], col = "dodgerblue", lwd = 3, lty = 3)
#lines(X_grid, Y_pi_band[,"upr"], col = "dodgerblue", lwd = 3, lty = 3)
points(mean(cats$Hwt), mean(cats$Bwt), pch = "+", cex = 7)
X_grid = seq(min(cats$Bwt), max(cats$Bwt), by = 0.01)
Y_ci_band = predict(cat_model,
newdata = data.frame(Bwt = X_grid),
interval = "confidence", level = 0.90)
Y_pi_band = predict(cat_model,
newdata = data.frame(Bwt = X_grid),
interval = "prediction", level = 0.90)
plot(Hwt ~ Bwt, data = cats,
xlab = "Body Weight (in Kg)",
ylab = "Heart Weight (in gm)",
main = "Heart Weight vs Body Weight of male and female cats ",
pch  = 20,
cex  = 2,
col  = "grey",
ylim = c(min(Y_pi_band), max(Y_pi_band)))
abline(cat_model, lwd = 5, col = "darkorange")
#lines(X_grid, Y_ci_band[,"lwr"], col = "dodgerblue", lwd = 3, lty = 2)
#lines(X_grid, Y_ci_band[,"upr"], col = "dodgerblue", lwd = 3, lty = 2)
#lines(X_grid, Y_pi_band[,"lwr"], col = "dodgerblue", lwd = 3, lty = 3)
#lines(X_grid, Y_pi_band[,"upr"], col = "dodgerblue", lwd = 3, lty = 3)
points(mean(cats$Hwt), mean(cats$Bwt), pch = "+", cex = 7, col = "black")
mean(cats$Hwt)
mean(cats$Bwt
)
X_grid = seq(min(cats$Bwt), max(cats$Bwt), by = 0.01)
Y_ci_band = predict(cat_model,
newdata = data.frame(Bwt = X_grid),
interval = "confidence", level = 0.90)
Y_pi_band = predict(cat_model,
newdata = data.frame(Bwt = X_grid),
interval = "prediction", level = 0.90)
plot(Hwt ~ Bwt, data = cats,
xlab = "Body Weight (in Kg)",
ylab = "Heart Weight (in gm)",
main = "Heart Weight vs Body Weight of male and female cats ",
pch  = 20,
cex  = 1,
col  = "grey",
ylim = c(min(Y_pi_band), max(Y_pi_band)))
abline(cat_model, lwd = 5, col = "darkorange")
#lines(X_grid, Y_ci_band[,"lwr"], col = "dodgerblue", lwd = 3, lty = 2)
#lines(X_grid, Y_ci_band[,"upr"], col = "dodgerblue", lwd = 3, lty = 2)
#lines(X_grid, Y_pi_band[,"lwr"], col = "dodgerblue", lwd = 3, lty = 3)
#lines(X_grid, Y_pi_band[,"upr"], col = "dodgerblue", lwd = 3, lty = 3)
points(mean(cats$Hwt), mean(cats$Bwt), pch = "+", cex = 7, col = "black")
X_grid = seq(min(cats$Bwt), max(cats$Bwt), by = 0.01)
Y_ci_band = predict(cat_model,
newdata = data.frame(Bwt = X_grid),
interval = "confidence", level = 0.90)
Y_pi_band = predict(cat_model,
newdata = data.frame(Bwt = X_grid),
interval = "prediction", level = 0.90)
plot(Hwt ~ Bwt, data = cats,
xlab = "Body Weight (in Kg)",
ylab = "Heart Weight (in gm)",
main = "Heart Weight vs Body Weight of male and female cats ",
pch  = 20,
cex  = 1,
col  = "grey",
ylim = c(min(Y_pi_band), max(Y_pi_band)))
abline(cat_model, lwd = 2, col = "darkorange")
#lines(X_grid, Y_ci_band[,"lwr"], col = "dodgerblue", lwd = 3, lty = 2)
#lines(X_grid, Y_ci_band[,"upr"], col = "dodgerblue", lwd = 3, lty = 2)
#lines(X_grid, Y_pi_band[,"lwr"], col = "dodgerblue", lwd = 3, lty = 3)
#lines(X_grid, Y_pi_band[,"upr"], col = "dodgerblue", lwd = 3, lty = 3)
points(mean(cats$Hwt), mean(cats$Bwt), pch = "+", cex = 7, col = "black")
X_grid = seq(min(cats$Bwt), max(cats$Bwt), by = 0.01)
Y_ci_band = predict(cat_model,
newdata = data.frame(Bwt = X_grid),
interval = "confidence", level = 0.90)
Y_pi_band = predict(cat_model,
newdata = data.frame(Bwt = X_grid),
interval = "prediction", level = 0.90)
plot(Hwt ~ Bwt, data = cats,
xlab = "Body Weight (in Kg)",
ylab = "Heart Weight (in gm)",
main = "Heart Weight vs Body Weight of male and female cats ",
pch  = 20,
cex  = 1,
col  = "grey",
ylim = c(min(Y_pi_band), max(Y_pi_band)))
#abline(cat_model, lwd = 2, col = "darkorange")
#lines(X_grid, Y_ci_band[,"lwr"], col = "dodgerblue", lwd = 3, lty = 2)
#lines(X_grid, Y_ci_band[,"upr"], col = "dodgerblue", lwd = 3, lty = 2)
#lines(X_grid, Y_pi_band[,"lwr"], col = "dodgerblue", lwd = 3, lty = 3)
#lines(X_grid, Y_pi_band[,"upr"], col = "dodgerblue", lwd = 3, lty = 3)
points(mean(cats$Hwt), mean(cats$Bwt), pch = "+", cex = 7, col = "black")
X_grid = seq(min(cats$Bwt), max(cats$Bwt), by = 0.01)
Y_ci_band = predict(cat_model,
newdata = data.frame(Bwt = X_grid),
interval = "confidence", level = 0.90)
Y_pi_band = predict(cat_model,
newdata = data.frame(Bwt = X_grid),
interval = "prediction", level = 0.90)
plot(Hwt ~ Bwt, data = cats,
xlab = "Body Weight (in Kg)",
ylab = "Heart Weight (in gm)",
main = "Heart Weight vs Body Weight of male and female cats ",
pch  = 20,
cex  = 1,
col  = "grey",
ylim = c(min(Y_pi_band), max(Y_pi_band)))
abline(cat_model, lwd = 2, col = "darkorange")
lines(X_grid, Y_ci_band[,"lwr"], col = "dodgerblue", lwd = 3, lty = 2)
lines(X_grid, Y_ci_band[,"upr"], col = "dodgerblue", lwd = 3, lty = 2)
lines(X_grid, Y_pi_band[,"lwr"], col = "dodgerblue", lwd = 3, lty = 3)
lines(X_grid, Y_pi_band[,"upr"], col = "dodgerblue", lwd = 3, lty = 3)
points(mean(cats$Hwt), mean(cats$Bwt), pch = "+", cex = 7, col = "black")
calc_pred_int = function(model,newdata,level=0.95){
data = newdata
n = nrow(model$model)
Se = summary(model)$sigma
x = model$model[,1]
estimate = predict(model, newdata=data)
crit = qt((1-level)/2, df=n-2, lower.tail = FALSE)
Sxx = sum((x - mean(x))^2)
g = sqrt(1 + 1/n + (data$Bwt -mean(x))^2/Sxx)
lower = estimate - crit * g
upper = estimate + crit * g
v = c(estimate, lower, upper)
names(v) = c("estimate", "lower", "upper")
return(v)
}
cat_model$model[,1]
cat_model$model
calc_pred_int = function(model,newdata,level=0.95){
data = newdata
n = nrow(model$model)
Se = summary(model)$sigma
x = model$model[,2]
estimate = predict(model, newdata=data)
crit = qt((1-level)/2, df=n-2, lower.tail = FALSE)
Sxx = sum((x - mean(x))^2)
g = sqrt(1 + 1/n + (data$Bwt -mean(x))^2/Sxx)
lower = estimate - crit * g
upper = estimate + crit * g
v = c(estimate, lower, upper)
names(v) = c("estimate", "lower", "upper")
return(v)
}
newcat_1 = data.frame(Bwt = 4.0)
calc_pred_int(cat_model, newcat_1)
newcat_2 = data.frame(Bwt = 3.3)
calc_pred_int(cat_model, newcat_2, level = 0.99)
hist(beta_0_hats, prob = TRUE, breaks = 20,
xlab = expression(hat(beta)[0]), main = "", border = "dodgerblue")
library(MASS)
data(cats)
cat_model = lm(Hwt ~ Bwt, data=cats)
summary(cat_model)$coefficients[2,c(3,4)]
confint(cat_model, parm="Bwt", level = 0.90)
confint(cat_model, parm = "(Intercept)" , level = 0.99)
predict(cat_model, newdata = data.frame(Bwt = c(2.1, 2.8)),
interval = c("confidence"), level = 0.99)
predict(cat_model, newdata = data.frame(Bwt = c(2.8, 4.2)),
interval = c("prediction"), level = 0.99)
X_grid = seq(min(cats$Bwt), max(cats$Bwt), by = 0.01)
Y_ci_band = predict(cat_model,
newdata = data.frame(Bwt = X_grid),
interval = "confidence", level = 0.90)
Y_pi_band = predict(cat_model,
newdata = data.frame(Bwt = X_grid),
interval = "prediction", level = 0.90)
plot(Hwt ~ Bwt, data = cats,
xlab = "Body Weight (in Kg)",
ylab = "Heart Weight (in gm)",
main = "Heart Weight vs Body Weight of male and female cats ",
pch  = 20,
cex  = 1,
col  = "grey",
ylim = c(min(Y_pi_band), max(Y_pi_band)))
abline(cat_model, lwd = 2, col = "darkorange")
lines(X_grid, Y_ci_band[,"lwr"], col = "dodgerblue", lwd = 3, lty = 2)
lines(X_grid, Y_ci_band[,"upr"], col = "dodgerblue", lwd = 3, lty = 2)
lines(X_grid, Y_pi_band[,"lwr"], col = "dodgerblue", lwd = 3, lty = 3)
lines(X_grid, Y_pi_band[,"upr"], col = "dodgerblue", lwd = 3, lty = 3)
points(mean(cats$Hwt), mean(cats$Bwt), pch = "+", cex = 7, col = "black")
beta_1_hat = coef(cat_model)[2]
RSS = summary(cat_model)$sigma
Sxx = sum((cats$Bwt - mean(cats$Bwt))^2)
SE_beta_1_hat = RSS / sqrt(Sxx)
t_val = (beta_1_hat - 4) / SE_beta_1_hat
p_val = 2 * pt(abs(t_val), nrow(cats)-2, lower.tail = FALSE)
c(t_val, p_val)
data(Ozone, package = "mlbench")
Ozone = Ozone[, c(4, 6, 7, 8)]
colnames(Ozone) = c("ozone", "wind", "humidity", "temp")
Ozone = Ozone[complete.cases(Ozone), ]
ozone_wind_model = lm(ozone ~ wind, data=Ozone)
summary(ozone_wind_model)$coefficients[2,c(3,4)]
ozone_temp_model = lm(ozone ~ temp, data=Ozone)
summary(ozone_temp_model)$coefficients[2,c(3,4)]
birthday = 19820517
set.seed(birthday)
n = 50
x = seq(0, 10, length = n)
beta_0=-5
beta_1=3.25
sigma = 4
num_samples = 2000
beta_0_hats = rep(0, num_samples)
beta_1_hats = rep(0, num_samples)
for (i in 1:num_samples) {
eps = rnorm(n, mean = 0, sd = sigma)
y   = beta_0 + beta_1 * x + eps
sim_model = lm(y ~ x)
beta_0_hats[i] = coef(sim_model)[1]
beta_1_hats[i] = coef(sim_model)[2]
}
Sxx = sum( (x-mean(x))^2 )
SE_beta_0_hat = sigma * sqrt((1/n + mean(x)^2/Sxx))
SE_beta_1_hat = sigma / sqrt(Sxx)
results = data.frame(
Measure = c("True Expected Value", "Meam of Simulated", "True SD", "SD from Simulated"),
Beta_0_hat = c(-5, mean(beta_0_hats), SE_beta_0_hat, sd(beta_0_hats)),
beta_1_hat = c(3.25, mean(beta_1_hats), SE_beta_1_hat, sd(beta_1_hats))
)
knitr::kable(results)
hist(beta_0_hats, prob = TRUE, breaks = 20,
xlab = expression(hat(beta)[0]), main = "", border = "dodgerblue")
curve(dnorm(x, mean = beta_0, sd = SE_beta_0_hat),
col = "darkorange", add = TRUE, lwd = 3)
hist(beta_1_hats, prob = TRUE, breaks = 20,
xlab = expression(hat(beta)[1]), main = "", border = "dodgerblue")
curve(dnorm(x, mean = beta_1, sd = SE_beta_1_hat),
col = "darkorange", add = TRUE, lwd = 3)
hist(beta_0_hats, prob = TRUE, breaks = 20,
xlab = expression(hat(beta)[0]), main = "", border = "dodgerblue")
curve(dnorm(x, mean = beta_0, sd = SE_beta_0_hat),
col = "darkorange", add = TRUE, lwd = 3)
hist(beta_1_hats, prob = TRUE, breaks = 20,
xlab = expression(hat(beta)[1]), main = "", border = "grey")
curve(dnorm(x, mean = beta_1, sd = SE_beta_1_hat),
col = "yellow", add = TRUE, lwd = 3)
par(mfrow=c(1,2))
hist(beta_0_hats, prob = TRUE, breaks = 20,
xlab = expression(hat(beta)[0]), main = "", border = "dodgerblue")
curve(dnorm(x, mean = beta_0, sd = SE_beta_0_hat),
col = "darkorange", add = TRUE, lwd = 3)
hist(beta_1_hats, prob = TRUE, breaks = 20,
xlab = expression(hat(beta)[1]), main = "", border = "grey")
curve(dnorm(x, mean = beta_1, sd = SE_beta_1_hat),
col = "yellow", add = TRUE, lwd = 3)
cat_model$model
cat_model$model[,2]
calc_pred_int = function(model,newdata,level=0.95){
data = newdata
n = nrow(model$model)
Se = summary(model)$sigma
x = model$model[,2]
estimate = predict(model, newdata=data)
crit = qt((1-level)/2, df=n-2, lower.tail = FALSE)
Sxx = sum((x - mean(x))^2)
g = sqrt(1 + 1/n + (data$Bwt -mean(x))^2/Sxx)
lower = estimate - crit * Se * g
upper = estimate + crit * Se * g
v = c(estimate, lower, upper)
names(v) = c("estimate", "lower", "upper")
return(v)
}
install.packages("Amelia")
library(Amelia)
library(mlbench)
install.packages("mlbench")
library(mlbench)
data("Soybean")
View(Soybean)
?Soybean
missmap(Soybean, col=c("black", "grey"), legend=FALSE)
missmap(Soybean, col=c("black", "grey"), legend=TRUE)
str(Soybean)
data("BreastCancer")
str(BreastCancer)
par(mfrow=c(2,4))
for(i in 2:9) {
counts <- table(BreastCancer[,i])
name <- names(BreastCancer)[i]
barplot(counts, main=name)
}
setwd("C:\\Users\\sk392506\\Documents\\MCSDS\\stat420\\assignment7")
install.packages("knitr")
install.packages("knitr")
install.packages("rmarkdown")
setwd("C:\\Users\\sk392506\\Documents\\MCSDS\\stat420\\assignment7")
options(scipen = 1, digits = 4, width = 80, fig.alin = "center")
epa <- read.csv(file="epa2015.csv")
str(epa)
is.factor(epa$type)
plot(CO2 ~ horse, data=epa, col=as.numeric(epa$type)+1,
ylab="Carbon dioxide (g/mi)",
xlab="Horsepower (foot-pounds per second)",
main="Horsepower vs Carbon dioxide",
pch=20,
cex=0.8)
legend("topright", c("Both", "Car", "Truck"), col=c(2,3,4), pch = 20)
epa_slr= lm(CO2 ~ horse, data=epa)
plot(CO2 ~ horse, data=epa, col=as.numeric(epa$type)+1,
ylab="Carbon dioxide (g/mi)",
xlab="Horsepower (foot-pounds per second)",
main="Horsepower vs Carbon dioxide",
pch=20,
cex=0.8)
abline(epa_slr, lwd = 2)
legend("topright", c("Both", "Car", "Truck"), col=c(2,3,4), pch = 20)
coef(epa_slr)[[2]]
predict(epa_slr, level=0.90, newdata = data.frame(horse=148), interval = "prediction")
plot(CO2 ~ horse, data=epa, col=as.numeric(epa$type)+1,
ylab="Carbon dioxide (g/mi)",
xlab="Horsepower (foot-pounds per second)",
main="Horsepower vs Carbon dioxide",
pch=20,
cex=0.8)
abline(epa_slr, lwd = 2)
legend("topright", c("Both", "Car", "Truck"), col=c(2,3,4), pch = 20)
(epa_add = lm(CO2 ~ horse + type, data=epa))
intcp_both  = coef(epa_add)[1]
intcp_car   = coef(epa_add)[1] + coef(epa_add)[3]
intcp_truck = coef(epa_add)[1] + coef(epa_add)[4]
slope_both  = coef(epa_add)[2]
slope_car   = coef(epa_add)[2]
slope_truck = coef(epa_add)[2]
plot(CO2 ~ horse, data=epa, col=as.numeric(epa$type)+1,
ylab="Carbon dioxide (g/mi)",
xlab="Horsepower (foot-pounds per second)",
main="Horsepower vs Carbon dioxide",
pch=20,
cex=0.8)
abline(intcp_both, slope_both, col = 2, lwd = 2)
abline(intcp_car, slope_car, col = 3, lwd = 2)
abline(intcp_truck, slope_truck, col = 4, lwd = 2)
legend("topright", c("Both", "Car", "Truck"), col=c(2,3,4), pch = 20)
coef(epa_add)[[2]]
predict(epa_add, newdata = data.frame(horse=148, type="Both"), level=0.90, interval = "prediction")
plot(CO2 ~ horse, data=epa, col=as.numeric(epa$type)+1,
ylab="Carbon dioxide (g/mi)",
xlab="Horsepower (foot-pounds per second)",
main="Horsepower vs Carbon dioxide",
pch=20,
cex=0.8)
abline(epa_slr, lwd = 2)
legend("topright", c("Both", "Car", "Truck"), col=c(2,3,4), pch = 20)
epa_int = lm(CO2 ~ horse * type, data=epa)
int_both  = coef(epa_int)[1]
int_car   = coef(epa_int)[1] + coef(epa_int)[3]
int_truck = coef(epa_int)[1] + coef(epa_int)[4]
slope_both  = coef(epa_int)[2]
slope_car   = coef(epa_int)[2] + coef(epa_int)[5]
slope_truck = coef(epa_int)[2] + coef(epa_int)[6]
plot(CO2 ~ horse, data=epa, col=as.numeric(epa$type)+1,
ylab="Carbon dioxide (g/mi)",
xlab="Horsepower (foot-pounds per second)",
main="Horsepower vs Carbon dioxide",
pch=20,
cex=0.8)
abline(int_both, slope_both, col = 2, lwd = 1)
abline(int_car, slope_car, col = 3, lwd = 1)
abline(int_truck, slope_truck, col = 4, lwd = 1)
legend("topright", c("Both", "Car", "Truck"), col=c(2,3,4), pch = 20)
coef(epa_int)[[2]] + coef(epa_int)[[5]]
predict(epa_int, newdata = data.frame(horse=148, type="Both"), level=0.90, interval = "prediction")
anova(epa_add, epa_int)
hospital <- read.csv(file="hospital.csv")
str(hospital)
is.factor(hospital$Education)
is.factor(hospital$Income)
is.factor(hospital$Sex)
levels(hospital$Education)
levels(hospital$Income)
levels(hospital$Sex)
mod_hosp_add = lm(Blood ~ Age + Education + Income + Sex, data=hospital)
mod_hosp_add
mod_hosp_int = lm(Blood ~ Age + Education + Income + Sex + Sex:Age + Sex:Income, data=hospital)
anova(mod_hosp_add,mod_hosp_int)
mod_hosp_int2 = lm(Blood ~ Age + Education + Income + Sex + Sex:Age +Sex:Income + Income:Age + Age:Income:Sex, data=hospital)
anova(mod_hosp_add,mod_hosp_int2)
sum(coef(mod_hosp_int2)[c(2,6,8,9)])
hospital <- read.csv(file="hospital.csv")
days_int = lm(Days ~ Pressure * Blood * Rate, data = hospital)
days_add = lm(Days ~ Pressure + Blood + Rate, data = hospital)
anova(days_add,days_int)
summary(days_int)$coefficients
n = 30
sim_data = data.frame(
groups = c(rep("A", n / 2), rep("B", n / 2)),
values = rep(0, n))
str(sim_data)
set.seed(420)
sim_data$values = rnorm(n, mean = 42, sd = 3.5) # simulate response data
summary(lm(values ~ groups, data = sim_data))
t.test(values ~ groups, data = sim_data, var.equal = TRUE)
num_sims = 300
lm_t = rep(0, num_sims)
lm_p = rep(0, num_sims)
tt_t = rep(0, num_sims)
tt_p = rep(0, num_sims)
birthday = 19820517
set.seed(birthday)
for (i in 1:num_sims){
sim_data$values = rnorm(n, mean = 42, sd = 3.5)
mod = lm (values ~ groups, data = sim_data)
lm_t[i] = summary(mod)[["coefficients"]]["groupsB", "t value"]
lm_p[i] = summary(mod)[["coefficients"]]["groupsB", "Pr(>|t|)"]
t_test=t.test(values ~ groups, data = sim_data, var.equal = TRUE)
tt_t[i]=t_test[["statistic"]]
tt_p[i]=t_test[["p.value"]]
}
mean(lm_t == tt_t)
mean(lm_p == tt_p)
all.equal(lm_p, tt_p)
head(lm_t)
head(tt_t)
